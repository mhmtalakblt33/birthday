:root{
  --bg1:#06112a;
  --bg2:#081b3f;
  --bg3:#0b2a66;

  --card1: rgba(11,23,53,.90);
  --card2: rgba(8,15,35,.85);

  --text:#eaf1ff;
  --muted:#b9c6e6;
  --stroke:rgba(255,255,255,.10);
  --shadow: 0 20px 70px rgba(0,0,0,.55);
  --radius: 24px;

  --pink:#ff6b8a;
  --mint:#8bffda;
  --blue:#7aa7ff;

  --cakeA:#6e4cff;
  --cakeB:#3c2aa8;
  --cream:#f3f7ff;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, Arial, sans-serif;
  color:var(--text);
  background:
    radial-gradient(1100px 700px at 20% 15%, var(--bg3), transparent 55%),
    radial-gradient(900px 600px at 85% 75%, #0a2c5c, transparent 55%),
    linear-gradient(160deg, var(--bg1), var(--bg2));
  overflow-x:hidden;
  position: relative;
}

/* Enhanced floating particles */
body::before,
body::after {
  content: '';
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: 0;
  animation: megaFloat 25s ease-in-out infinite;
}

body::before {
  width: 800px;
  height: 800px;
  top: -300px;
  right: -300px;
  background: radial-gradient(circle, rgba(255,107,138,.12), transparent 70%);
}

body::after {
  width: 600px;
  height: 600px;
  bottom: -200px;
  left: -200px;
  background: radial-gradient(circle, rgba(139,255,218,.10), transparent 70%);
  animation-delay: -12s;
}

@keyframes megaFloat {
  0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 0.8; }
  25% { transform: translate(80px, -60px) scale(1.15) rotate(90deg); opacity: 0.6; }
  50% { transform: translate(-40px, 80px) scale(0.9) rotate(180deg); opacity: 0.9; }
  75% { transform: translate(60px, 40px) scale(1.1) rotate(270deg); opacity: 0.7; }
}

/* BG Enhanced */
.bg{ 
  position:fixed; 
  inset:0; 
  pointer-events:none;
  z-index: 1;
}

.glow{
  position:absolute;
  width:520px; 
  height:520px;
  border-radius:50%;
  mix-blend-mode:screen;
  animation: floaty 10s ease-in-out infinite;
  filter: blur(60px);
}

.glow.g1{ 
  top:-140px; 
  left:-120px; 
  background: radial-gradient(circle at 30% 30%, rgba(122,167,255,.65), transparent 60%);
  animation-duration: 12s;
}

.glow.g2{ 
  top:40%; 
  left:70%; 
  width:620px; 
  height:620px; 
  background: radial-gradient(circle at 35% 35%, rgba(139,255,218,.40), transparent 62%);
  animation-duration: 15s;
  animation-delay: -5s;
}

.glow.g3{ 
  top:65%; 
  left:10%; 
  width:420px; 
  height:420px; 
  background: radial-gradient(circle at 40% 40%, rgba(255,107,138,.30), transparent 62%);
  animation-duration: 18s;
  animation-delay: -8s;
}

@keyframes floaty{
  0%,100%{ transform: translate(0,0) scale(1); opacity:.9; }
  33%{ transform: translate(40px, -30px) scale(1.08); opacity:.7; }
  66%{ transform: translate(-25px, 35px) scale(0.95); opacity:.85; }
}

/* Sparkle overlay */
.bg::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: 
    radial-gradient(2px 2px at 15% 25%, white, transparent),
    radial-gradient(2px 2px at 45% 15%, white, transparent),
    radial-gradient(1px 1px at 75% 35%, white, transparent),
    radial-gradient(2px 2px at 85% 65%, white, transparent),
    radial-gradient(1px 1px at 25% 75%, white, transparent),
    radial-gradient(2px 2px at 55% 85%, white, transparent),
    radial-gradient(1px 1px at 90% 20%, white, transparent),
    radial-gradient(2px 2px at 10% 55%, white, transparent);
  background-size: 300% 300%;
  background-position: 0% 0%;
  animation: sparkleMove 20s ease-in-out infinite;
  opacity: 0.4;
}

@keyframes sparkleMove {
  0%, 100% { opacity: 0.3; background-position: 0% 0%; }
  50% { opacity: 0.6; background-position: 100% 100%; }
}

/* Layout */
.wrap{ 
  height:100%; 
  display:grid; 
  place-items:center; 
  padding:16px;
  position: relative;
  z-index: 2;
}

.card{
  width:min(880px, 94vw);
  max-height: 94vh;
  padding: clamp(18px, 3.5vh, 38px) clamp(16px, 2.8vw, 32px);
  border:1px solid rgba(255,255,255,.18);
  border-radius: var(--radius);
  box-shadow: 
    var(--shadow),
    0 0 120px rgba(122,167,255,.15),
    inset 0 1px 0 rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, var(--card1) 0%, var(--card2) 100%);
  backdrop-filter: blur(25px);
  position: relative;
  overflow: hidden;
  animation: cardMegaEntry 1s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes cardMegaEntry {
  from {
    opacity: 0;
    transform: scale(0.85) translateY(80px) rotateX(15deg);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0) rotateX(0);
  }
}

/* Card mega glow */
.card::before {
  content: '';
  position: absolute;
  top: -100%;
  left: -100%;
  width: 300%;
  height: 300%;
  background: 
    radial-gradient(circle at 30% 30%, rgba(122,167,255,.12), transparent 40%),
    radial-gradient(circle at 70% 70%, rgba(255,107,138,.10), transparent 40%);
  animation: cardMegaGlow 12s ease-in-out infinite;
  pointer-events: none;
}

@keyframes cardMegaGlow {
  0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 0.6; }
  50% { transform: translate(30px, 30px) rotate(180deg); opacity: 0.9; }
}

/* Top section */
.top{ 
  text-align:center;
  position: relative;
  z-index: 2;
}

.title{ 
  margin:0 0 10px; 
  font-size: clamp(26px, 4vw, 42px);
  font-weight: 900;
  background: linear-gradient(135deg, #fff 0%, var(--pink) 50%, var(--mint) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  background-size: 200% auto;
  letter-spacing: -0.5px;
  animation: titleMegaShimmer 4s ease-in-out infinite;
  filter: drop-shadow(0 0 30px rgba(255,107,138,.4));
  position: relative;
}

@keyframes titleMegaShimmer {
  0%, 100% { background-position: 0% 50%; filter: drop-shadow(0 0 30px rgba(255,107,138,.4)); }
  50% { background-position: 100% 50%; filter: drop-shadow(0 0 40px rgba(139,255,218,.5)); }
}

.sub{ 
  margin:0; 
  color:var(--muted); 
  font-size: 14px;
  font-weight: 600;
  letter-spacing: 0.5px;
  animation: subtlePulse 3s ease-in-out infinite;
}

@keyframes subtlePulse {
  0%, 100% { opacity: 0.85; }
  50% { opacity: 1; }
}

/* Stage with enhanced effects */
.stage{
  margin-top: 20px;
  display:grid;
  place-items:center;
  position:relative;
  padding: 16px 0 10px;
}

.cakeShadow{
  width:min(540px, 92vw);
  height: 32px;
  border-radius: 999px;
  background: radial-gradient(circle, rgba(0,0,0,.65), transparent 70%);
  filter: blur(12px);
  opacity:.65;
  transform: translateY(175px);
  animation: shadowPulse 3s ease-in-out infinite;
}

@keyframes shadowPulse {
  0%, 100% { transform: translateY(175px) scale(1); opacity: 0.65; }
  50% { transform: translateY(175px) scale(1.05); opacity: 0.75; }
}

/* Cake with mega enhancements */
.cake{
  width: min(540px, 92vw);
  height: 360px;
  position:relative;
  animation: cakeEntry 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s backwards;
  filter: drop-shadow(0 30px 60px rgba(0,0,0,.4));
}

@keyframes cakeEntry {
  from {
    opacity: 0;
    transform: scale(0.7) translateY(100px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.plate{
  position:absolute;
  bottom: 16px;
  left:50%;
  transform: translateX(-50%);
  width: 86%;
  height: 20px;
  border-radius: 999px;
  background: 
    linear-gradient(90deg, 
      rgba(255,255,255,.22), 
      rgba(255,255,255,.08), 
      rgba(255,255,255,.22));
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 
    0 20px 60px rgba(0,0,0,.5),
    inset 0 2px 4px rgba(255,255,255,.15);
  animation: plateShine 4s ease-in-out infinite;
}

@keyframes plateShine {
  0%, 100% { box-shadow: 0 20px 60px rgba(0,0,0,.5), inset 0 2px 4px rgba(255,255,255,.15); }
  50% { box-shadow: 0 25px 70px rgba(0,0,0,.6), inset 0 2px 8px rgba(255,255,255,.25); }
}

.tier{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  border-radius: 22px;
  border:1px solid rgba(255,255,255,.15);
  box-shadow: 
    0 20px 60px rgba(0,0,0,.45),
    inset 0 2px 0 rgba(255,255,255,.1);
  position: relative;
  overflow: hidden;
}

/* Tier shimmer effect */
.tier::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.15), transparent);
  animation: tierShimmer 3s ease-in-out infinite;
}

@keyframes tierShimmer {
  0% { left: -100%; }
  100% { left: 200%; }
}

.tierBot{
  bottom: 28px;
  width: 80%;
  height: 112px;
  background: 
    linear-gradient(180deg, rgba(110,76,255,.98), rgba(60,42,168,.98));
  animation: tierBotPulse 4s ease-in-out infinite;
}

.tierMid{
  bottom: 122px;
  width: 64%;
  height: 96px;
  background:
    linear-gradient(180deg, rgba(139,255,218,.25), rgba(122,167,255,.20)),
    linear-gradient(180deg, rgba(110,76,255,.92), rgba(60,42,168,.92));
  background-blend-mode: screen, normal;
  animation: tierMidPulse 4s ease-in-out infinite 0.5s;
}

.tierTop{
  bottom: 204px;
  width: 48%;
  height: 82px;
  background:
    linear-gradient(180deg, rgba(255,107,138,.25), rgba(139,255,218,.18)),
    linear-gradient(180deg, rgba(110,76,255,.90), rgba(60,42,168,.90));
  background-blend-mode: screen, normal;
  animation: tierTopPulse 4s ease-in-out infinite 1s;
}

@keyframes tierBotPulse {
  0%, 100% { transform: translateX(-50%) scale(1); }
  50% { transform: translateX(-50%) scale(1.02); }
}

@keyframes tierMidPulse {
  0%, 100% { transform: translateX(-50%) scale(1); }
  50% { transform: translateX(-50%) scale(1.03); }
}

@keyframes tierTopPulse {
  0%, 100% { transform: translateX(-50%) scale(1); }
  50% { transform: translateX(-50%) scale(1.04); }
}

.topFrost{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  bottom: 268px;
  width: 48%;
  height: 34px;
  border-radius: 999px;
  background: 
    linear-gradient(180deg, rgba(243,247,255,1), rgba(243,247,255,.65));
  box-shadow: 
    0 16px 35px rgba(0,0,0,.3),
    inset 0 2px 0 rgba(255,255,255,.3);
  border:1px solid rgba(255,255,255,.18);
  animation: frostGlow 3s ease-in-out infinite;
}

@keyframes frostGlow {
  0%, 100% { 
    box-shadow: 0 16px 35px rgba(0,0,0,.3), inset 0 2px 0 rgba(255,255,255,.3);
    filter: brightness(1);
  }
  50% { 
    box-shadow: 0 18px 40px rgba(0,0,0,.35), inset 0 3px 0 rgba(255,255,255,.4);
    filter: brightness(1.1);
  }
}

.drips{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  bottom: 244px;
  width: 48%;
  height: 66px;
  pointer-events:none;
}

.drips::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 10% 0%, rgba(243,247,255,.90) 0 20px, transparent 21px),
    radial-gradient(circle at 30% 0%, rgba(243,247,255,.82) 0 16px, transparent 17px),
    radial-gradient(circle at 55% 0%, rgba(243,247,255,.92) 0 22px, transparent 23px),
    radial-gradient(circle at 75% 0%, rgba(243,247,255,.78) 0 14px, transparent 15px),
    radial-gradient(circle at 92% 0%, rgba(243,247,255,.86) 0 18px, transparent 19px);
  filter: drop-shadow(0 12px 14px rgba(0,0,0,.22));
  opacity:.98;
  animation: dripShine 4s ease-in-out infinite;
}

@keyframes dripShine {
  0%, 100% { opacity: 0.98; filter: drop-shadow(0 12px 14px rgba(0,0,0,.22)); }
  50% { opacity: 1; filter: drop-shadow(0 14px 18px rgba(0,0,0,.25)) brightness(1.05); }
}

.sprinkles{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  bottom: 274px;
  width: 46%;
  height: 28px;
  background:
    linear-gradient(15deg, rgba(255,107,138,.95) 0 6px, transparent 6px 14px, rgba(139,255,218,1) 14px 20px, transparent 20px 28px, rgba(122,167,255,1) 28px 34px, transparent 34px 42px) 0 0/48px 24px,
    linear-gradient(-20deg, rgba(255,255,255,.95) 0 4px, transparent 4px 10px, rgba(255,107,138,.90) 10px 16px, transparent 16px 24px) 18px 6px/44px 22px;
  opacity:.85;
  border-radius: 999px;
  animation: sprinkleGlow 5s ease-in-out infinite;
}

@keyframes sprinkleGlow {
  0%, 100% { opacity: 0.85; filter: brightness(1); }
  50% { opacity: 0.95; filter: brightness(1.15); }
}

/* Enhanced Candles */
.candles{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  bottom: 272px;
  width: 48%;
  height: 95px;
}

.candle{
  position:absolute;
  left: var(--x);
  bottom: 0;
  transform: translateX(-50%);
  width: 18px;
  height: 64px;
  filter: drop-shadow(0 14px 22px rgba(0,0,0,.4));
  animation: candleSway 2s ease-in-out infinite;
  animation-delay: calc(var(--x) * 0.02);
}

@keyframes candleSway {
  0%, 100% { transform: translateX(-50%) rotate(0deg); }
  50% { transform: translateX(-50%) rotate(1deg); }
}

.cBody{
  position:absolute;
  inset:0;
  border-radius: 12px;
  border:1px solid rgba(255,255,255,.22);
  background:
    repeating-linear-gradient(135deg,
      rgba(255,255,255,.85) 0 6px,
      rgba(122,167,255,.45) 6px 12px,
      rgba(255,107,138,.40) 12px 18px);
  box-shadow: inset 0 2px 4px rgba(255,255,255,.3);
}

.wick{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  top: -8px;
  width: 2px;
  height: 11px;
  background: rgba(0,0,0,.75);
  border-radius: 99px;
}

.flame{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  top: -34px;
  width: 20px;
  height: 32px;
  border-radius: 50%;
  background:
    radial-gradient(circle at 35% 30%, #fff7c8 0 35%, #ffc34d 55%, #ff6b2d 82%);
  filter: drop-shadow(0 0 20px rgba(255,196,77,.65)) brightness(1.1);
  animation: megaFlicker 120ms infinite alternate;
  opacity: 1;
}

@keyframes megaFlicker{
  from{ 
    transform: translateX(-50%) rotate(-3deg) scale(0.96); 
    filter: drop-shadow(0 0 18px rgba(255,196,77,.6)) brightness(1.05);
  }
  to{ 
    transform: translateX(-50%) rotate(3deg) scale(1.05); 
    filter: drop-shadow(0 0 24px rgba(255,196,77,.75)) brightness(1.15);
  }
}

.smoke{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  top: -28px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: rgba(255,255,255,.28);
  opacity: 0;
}

.blown .flame{ 
  opacity:0; 
  animation:flameOut 0.4s ease-out forwards;
}

@keyframes flameOut {
  from { 
    opacity: 1; 
    transform: translateX(-50%) scale(1);
  }
  to { 
    opacity: 0; 
    transform: translateX(-50%) scale(0.5) translateY(-10px);
  }
}

.blown .smoke{
  opacity: 1;
  animation: megaSmokeUp 2s ease-out infinite;
}

@keyframes megaSmokeUp{
  0%{ 
    transform: translateX(-50%) translateY(0) scale(.7); 
    opacity: 0; 
  }
  15%{ 
    opacity:.45; 
  }
  100%{ 
    transform: translateX(-50%) translateY(-42px) scale(2.2); 
    opacity: 0; 
  }
}

/* Enhanced Controls */
.controls{
  margin-top: 14px;
  display:grid;
  gap: 12px;
  justify-items:center;
}

.btn{
  width:min(560px, 100%);
  padding: 16px 18px;
  border-radius: 18px;
  border:1px solid rgba(122,167,255,.45);
  background: 
    linear-gradient(135deg, rgba(122,167,255,.28), rgba(139,255,218,.22));
  color: var(--text);
  font-weight: 900;
  font-size: 15px;
  cursor:pointer;
  box-shadow: 
    0 16px 50px rgba(0,0,0,.4),
    inset 0 1px 0 rgba(255,255,255,.15);
  transition: all .2s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255,255,255,.25);
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
}

.btn:hover{ 
  transform: translateY(-3px) scale(1.02); 
  border-color: rgba(139,255,218,.65);
  box-shadow: 
    0 20px 60px rgba(122,167,255,.5),
    inset 0 1px 0 rgba(255,255,255,.25);
}

.btn:hover::before {
  width: 400px;
  height: 400px;
}

.btn:active{ 
  transform: translateY(-1px) scale(1); 
}

.btn:disabled{ 
  opacity:.5; 
  cursor:not-allowed; 
  transform:none; 
}

.status{
  font-size: 13px;
  color: rgba(185,198,230,.90);
  font-weight: 600;
  animation: statusPulse 2s ease-in-out infinite;
}

@keyframes statusPulse {
  0%, 100% { opacity: 0.9; }
  50% { opacity: 1; }
}

/* Mega Enhanced Gift */
.hidden{ display:none !important; }

.giftArea{
  margin-top: 22px;
  display:grid;
  justify-items:center;
  gap: 14px;
  animation: megaRiseIn .8s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}

@keyframes megaRiseIn{
  from{ 
    opacity:0; 
    transform: translateY(40px) scale(0.9); 
  }
  to{ 
    opacity:1; 
    transform: translateY(0) scale(1); 
  }
}

.giftTitle{
  font-size: 14px;
  font-weight: 700;
  color: rgba(234,241,255,.95);
  background: 
    linear-gradient(135deg, rgba(122,167,255,.2), rgba(139,255,218,.15));
  border: 1px solid rgba(255,255,255,.15);
  padding: 10px 18px;
  border-radius: 999px;
  box-shadow: 
    0 8px 24px rgba(0,0,0,.3),
    inset 0 1px 0 rgba(255,255,255,.15);
  animation: titleFloat 3s ease-in-out infinite;
  letter-spacing: 0.5px;
}

@keyframes titleFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

.giftHint{
  font-size: 13px;
  color: rgba(185,198,230,.90);
  font-weight: 600;
  animation: hintBlink 2s ease-in-out infinite;
}

@keyframes hintBlink {
  0%, 100% { opacity: 0.9; }
  50% { opacity: 1; }
}

.gift{
  width: 180px;
  height: 165px;
  border:none;
  background:transparent;
  cursor:pointer;
  position:relative;
  outline:none;
  animation: megaBob 1.5s ease-in-out infinite;
  filter: drop-shadow(0 20px 50px rgba(0,0,0,.4));
  transition: transform 0.3s ease;
}

.gift:hover {
  animation-play-state: paused;
  transform: scale(1.08) translateY(-8px);
}

@keyframes megaBob{
  0%,100%{ transform: translateY(0) rotate(0deg); }
  25%{ transform: translateY(-8px) rotate(-2deg); }
  75%{ transform: translateY(-4px) rotate(2deg); }
}

.giftBox{
  position:absolute;
  bottom: 0;
  left:50%;
  transform: translateX(-50%);
  width: 170px;
  height: 118px;
  border-radius: 20px;
  background: 
    linear-gradient(180deg, rgba(255,107,138,.95), rgba(255,107,138,.65));
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 
    0 25px 65px rgba(0,0,0,.5),
    inset 0 2px 0 rgba(255,255,255,.15);
  overflow:hidden;
  position: relative;
}

.giftBox::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,.15), transparent);
  animation: boxShine 3s ease-in-out infinite;
}

@keyframes boxShine {
  0%, 100% { opacity: 0; }
  50% { opacity: 1; }
}

.giftLid{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  bottom: 100px;
  width: 182px;
  height: 48px;
  border-radius: 20px;
  background: 
    linear-gradient(180deg, rgba(255,107,138,1), rgba(255,107,138,.72));
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 
    0 18px 45px rgba(0,0,0,.4),
    inset 0 2px 0 rgba(255,255,255,.2);
  overflow:hidden;
  transform-origin: 50% 100%;
  position: relative;
}

.giftLid::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,.2), transparent);
  animation: lidShine 3s ease-in-out infinite;
}

@keyframes lidShine {
  0%, 100% { opacity: 0; }
  50% { opacity: 1; }
}

.ribbonV{
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  top:0;
  width: 30px;
  height: 100%;
  background: 
    linear-gradient(180deg, rgba(139,255,218,.98), rgba(122,167,255,.65));
  opacity:.98;
  border-radius: 999px;
  box-shadow: 
    0 0 20px rgba(139,255,218,.4),
    inset 0 1px 0 rgba(255,255,255,.3);
}

.ribbonH{
  position:absolute;
  left:0;
  top:50%;
  transform: translateY(-50%);
  width: 100%;
  height: 20px;
  background: 
    linear-gradient(90deg, rgba(139,255,218,.92), rgba(122,167,255,.65));
  opacity:.60;
  box-shadow: 
    0 0 15px rgba(139,255,218,.3),
    inset 0 1px 0 rgba(255,255,255,.2);
}

.giftBox .ribbonH{ 
  opacity:.40; 
  height: 22px; 
}

.giftBox .ribbonV{ 
  width: 32px;
}

.bow{
  position:absolute;
  left:50%;
  top: -6px;
  transform: translateX(-50%);
  width: 96px;
  height: 48px;
  display:flex;
  justify-content:space-between;
  pointer-events:none;
  filter: drop-shadow(0 8px 16px rgba(0,0,0,.3));
}

.bow span{
  width: 44px;
  height: 36px;
  border-radius: 20px;
  background: 
    linear-gradient(180deg, rgba(139,255,218,1), rgba(122,167,255,.75));
  border:1px solid rgba(255,255,255,.2);
  box-shadow: 
    0 14px 28px rgba(0,0,0,.3),
    inset 0 2px 0 rgba(255,255,255,.3);
  animation: bowPulse 2s ease-in-out infinite;
}

@keyframes bowPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.bow span:first-child{ 
  transform: rotate(-18deg);
  animation-delay: 0s;
}

.bow span:last-child{ 
  transform: rotate(18deg);
  animation-delay: 0.5s;
}

.gift.open .giftLid{
  animation: megaLidPop .7s cubic-bezier(.2,.9,.2,1) forwards;
}

@keyframes megaLidPop{
  0%{ 
    transform: translateX(-50%) rotate(0); 
  }
  40%{
    transform: translateX(-50%) translateY(-8px) rotate(-12deg); 
  }
  60%{ 
    transform: translateX(-50%) translateY(-16px) rotate(-20deg); 
  }
  100%{ 
    transform: translateX(-50%) translateY(-24px) rotate(-25deg); 
  }
}

/* Confetti when gift opens */
@keyframes confetti {
  0% {
    transform: translateY(0) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(-500px) rotate(720deg);
    opacity: 0;
  }
}

/* MENU Enhanced */
.menuOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.70);
  backdrop-filter: blur(12px);
  display:grid;
  place-items:center;
  z-index: 999;
  animation: menuFadeIn 0.4s ease;
}

@keyframes menuFadeIn {
  from { 
    opacity: 0; 
    backdrop-filter: blur(0);
  }
  to { 
    opacity: 1; 
    backdrop-filter: blur(12px);
  }
}

.menuOverlay.hidden{ display:none; }

.menuBox{
  width: min(560px, 92vw);
  max-height: 90vh;
  overflow-y: auto;
  border-radius: 24px;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(10,16,40,.95);
  box-shadow: 
    0 35px 100px rgba(0,0,0,.7),
    0 0 0 1px rgba(255,255,255,.05),
    inset 0 1px 0 rgba(255,255,255,.1);
  padding: 20px 20px 18px;
  backdrop-filter: blur(20px);
  animation: menuBoxEntry 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes menuBoxEntry {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(50px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.panel{ 
  display:none;
  animation: panelFadeIn 0.3s ease;
}

@keyframes panelFadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.panel.active{ display:block; }

.menuTitle{
  margin: 4px 0 16px;
  font-size: 22px;
  font-weight: 900;
  letter-spacing: 0.3px;
  background: linear-gradient(135deg, var(--text), var(--blue));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.menuItem{
  width: 100%;
  display:flex;
  align-items:center;
  gap: 14px;
  padding: 14px 14px;
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  color: var(--text);
  font-weight: 800;
  cursor:pointer;
  text-align:left;
  margin: 10px 0;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 
    0 4px 15px rgba(0,0,0,.2),
    inset 0 1px 0 rgba(255,255,255,.05);
  position: relative;
  overflow: hidden;
}

.menuItem::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.1), transparent);
  transition: left 0.5s ease;
}

.menuItem:hover::before {
  left: 100%;
}

.menuItem:hover{ 
  background: 
    linear-gradient(135deg, rgba(255,255,255,.12), rgba(255,255,255,.08));
  transform: translateX(4px) scale(1.02);
  box-shadow: 
    0 8px 25px rgba(0,0,0,.3),
    inset 0 1px 0 rgba(255,255,255,.1);
  border-color: rgba(255,255,255,.25);
}

.menuItem:active {
  transform: translateX(2px) scale(1);
}

.dot{
  width: 16px; 
  height: 16px;
  border-radius: 6px;
  display:inline-block;
  box-shadow: 
    0 4px 12px rgba(0,0,0,.3),
    inset 0 1px 0 rgba(255,255,255,.3);
  animation: dotPulse 2s ease-in-out infinite;
}

@keyframes dotPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.dot.red{ 
  background: linear-gradient(135deg, #ff6b6b, #ff4b4b);
  animation-delay: 0s;
}

.dot.blue{ 
  background: linear-gradient(135deg, #6bb3ff, #4b9fff);
  animation-delay: 0.2s;
}

.dot.yellow{ 
  background: linear-gradient(135deg, #ffd96b, #ffd24b);
  animation-delay: 0.4s;
}

.dot.orange{ 
  background: linear-gradient(135deg, #ffa36b, #ff8a4b);
  animation-delay: 0.6s;
}

.dot.purple{ 
  background: linear-gradient(135deg, #c96bff, #b34bff);
  animation-delay: 0.8s;
}

.panelHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 6px 4px 14px;
  margin-bottom: 12px;
  border-bottom: 1px solid rgba(255,255,255,.08);
}

.panelHeader span{ 
  font-weight: 900;
  font-size: 18px;
  background: linear-gradient(135deg, var(--text), var(--mint));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.x{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  color: var(--text);
  cursor:pointer;
  font-size: 18px;
  transition: all 0.3s ease;
  box-shadow: 
    0 4px 12px rgba(0,0,0,.2),
    inset 0 1px 0 rgba(255,255,255,.05);
}

.x:hover {
  background: 
    linear-gradient(135deg, rgba(255,107,138,.2), rgba(255,107,138,.1));
  transform: rotate(90deg) scale(1.1);
  border-color: rgba(255,107,138,.4);
}

/* Friends list enhanced */
.list{ 
  display:grid; 
  gap: 12px; 
}

.listItem{
  padding: 14px 14px;
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(0,0,0,.2), rgba(0,0,0,.15));
  color: var(--text);
  cursor:pointer;
  text-align:left;
  font-weight: 800;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 
    0 4px 15px rgba(0,0,0,.25),
    inset 0 1px 0 rgba(255,255,255,.05);
  position: relative;
  overflow: hidden;
}

.listItem::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(180deg, var(--blue), var(--mint));
  opacity: 0;
  transition: opacity 0.3s ease;
}

.listItem:hover::before {
  opacity: 1;
}

.listItem:hover{ 
  background: 
    linear-gradient(135deg, rgba(122,167,255,.15), rgba(139,255,218,.10));
  transform: translateX(6px);
  border-color: rgba(122,167,255,.3);
}

/* Letter enhanced */
.letterText{
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(0,0,0,.2), rgba(0,0,0,.15));
  padding: 18px;
  line-height: 1.6;
  color: rgba(234,241,255,.95);
  box-shadow: 
    0 8px 24px rgba(0,0,0,.3),
    inset 0 1px 0 rgba(255,255,255,.05);
  font-size: 15px;
}

/* Memories carousel enhanced */
.carousel{
  display:flex;
  align-items:center;
  gap: 12px;
}

.nav{
  width: 50px;
  height: 50px;
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  color: var(--text);
  cursor:pointer;
  font-size: 20px;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 
    0 4px 15px rgba(0,0,0,.25),
    inset 0 1px 0 rgba(255,255,255,.05);
}

.nav:hover {
  background: 
    linear-gradient(135deg, rgba(122,167,255,.2), rgba(139,255,218,.15));
  transform: scale(1.1);
  border-color: rgba(122,167,255,.3);
}

.nav:active {
  transform: scale(1.05);
}

.memBox{ 
  flex:1; 
  text-align:center;
}

.memBox img{
  width: 100%;
  max-height: 360px;
  object-fit: cover;
  border-radius: 20px;
  border:1px solid rgba(255,255,255,.18);
  box-shadow: 
    0 12px 40px rgba(0,0,0,.4),
    inset 0 1px 0 rgba(255,255,255,.1);
  transition: transform 0.3s ease;
}

.memBox img:hover {
  transform: scale(1.02);
}

.memNote{ 
  margin-top: 10px; 
  font-size: 14px; 
  color: rgba(234,241,255,.92);
  font-weight: 600;
}

.memCount{ 
  margin-top: 6px; 
  font-size: 13px; 
  color: rgba(185,198,230,.88);
  font-weight: 600;
}

.memHint{ 
  margin-top: 12px; 
  font-size: 12px; 
  color: rgba(185,198,230,.80);
}

.memHint code{
  background: rgba(255,255,255,.10);
  padding: 3px 8px;
  border-radius: 10px;
  border:1px solid rgba(255,255,255,.12);
  font-family: 'Courier New', monospace;
}

/* Reasons enhanced */
.reasons{
  margin: 0;
  padding-left: 22px;
  line-height: 1.7;
  color: rgba(234,241,255,.95);
}

.reasons li{ 
  margin: 10px 0;
  font-size: 15px;
  position: relative;
  padding-left: 8px;
}

.reasons li::before {
  content: 'üíù';
  position: absolute;
  left: -28px;
  font-size: 18px;
  animation: heartBeat 1.5s ease-in-out infinite;
  animation-delay: calc(var(--i, 0) * 0.2s);
}

@keyframes heartBeat {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

/* Surprise enhanced */
.surpriseBox{
  text-align:center;
  padding: 22px;
  border-radius: 20px;
  border:1px solid rgba(255,255,255,.15);
  background: 
    linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  color: rgba(234,241,255,.95);
  box-shadow: 
    0 8px 24px rgba(0,0,0,.3),
    inset 0 1px 0 rgba(255,255,255,.05);
  font-size: 15px;
  line-height: 1.6;
}

/* Scrollbar styling */
.menuBox::-webkit-scrollbar {
  width: 8px;
}

.menuBox::-webkit-scrollbar-track {
  background: rgba(0,0,0,.2);
  border-radius: 10px;
}

.menuBox::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--blue), var(--mint));
  border-radius: 10px;
}

.menuBox::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, var(--mint), var(--blue));
}

/* Responsive */
@media (max-width: 600px) {
  .title { font-size: clamp(22px, 6vw, 32px); }
  .cake { height: 320px; }
  .tierBot { height: 100px; }
  .tierMid { height: 86px; }
  .tierTop { height: 74px; }
  .candles { bottom: 252px; height: 85px; }
  .candle { width: 16px; height: 58px; }
  .gift { width: 160px; height: 150px; }
}
