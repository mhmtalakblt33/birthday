/* GENEL */
:root {
    --bg-dark: #121212;
    --cake-brown: #5D4037;
    --cake-pink: #F48FB1;
    --icing-white: #FFF3E0;
    --flame-yellow: #FFD54F;
    --flame-orange: #FF5722;
    --glow-warm: rgba(255, 167, 38, 0.5);
}

body {
    margin: 0; padding: 0; height: 100vh; overflow: hidden;
    background-color: var(--bg-dark);
    font-family: 'Poppins', sans-serif;
    display: flex; justify-content: center; align-items: center;
    transition: background-color 1.5s ease;
}

/* --- IŞIKLANDIRMA --- */
.glow-source {
    position: absolute; top: 40%; left: 50%;
    transform: translate(-50%, -50%);
    width: 600px; height: 600px;
    background: radial-gradient(circle, var(--glow-warm) 0%, transparent 60%);
    filter: blur(60px); z-index: 0; opacity: 1;
    animation: glowPulse 3s infinite alternate; transition: opacity 1s;
}
.glow-source.off { opacity: 0; }

@keyframes glowPulse {
    0% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
    100% { transform: translate(-50%, -50%) scale(1.05); opacity: 1; }
}

.party-bg {
    position: absolute; inset: 0;
    background: radial-gradient(circle at center, #2E3192 0%, #000 90%);
    opacity: 0; transition: opacity 2s; z-index: 0;
}
.party-bg.on { opacity: 1; }

.stage {
    position: relative; z-index: 10;
    width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
}

/* --- YAZI --- */
.header-msg {
    position: absolute; top: 12%; text-align: center;
    opacity: 0; transform: translateY(20px); transition: all 1s;
}
.header-msg.visible { opacity: 1; transform: translateY(0); }

.title {
    font-family: 'Dancing Script', cursive;
    font-size: 4rem; color: #fff; margin: 0;
    text-shadow: 0 0 10px #FF4081, 0 0 20px #FF4081;
}

/* --- PASTA DÜZENİ --- */
.cake-wrapper {
    position: relative; margin-top: 40px;
    filter: drop-shadow(0 20px 30px rgba(0,0,0,0.6));
}

.cake {
    display: flex; flex-direction: column; align-items: center; position: relative;
}

/* --- KATMAN TASARIMI --- */
.tier {
    position: relative; width: 100%;
    background: linear-gradient(to bottom, 
        var(--cake-brown) 0%, var(--cake-brown) 30%, 
        var(--cake-pink) 30%, var(--cake-pink) 70%, 
        var(--cake-brown) 70%, var(--cake-brown) 100%
    );
    border-radius: 8px;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
    margin-bottom: -1px;
}

.tier-top { width: 160px; height: 70px; z-index: 4; border-radius: 15px 15px 5px 5px; }
.tier-middle { width: 220px; height: 80px; z-index: 3; }
.tier-bottom { width: 280px; height: 90px; z-index: 2; border-radius: 5px 5px 15px 15px; }

/* Krema */
.tier-frosting {
    position: absolute; top: 0; left: -2%; width: 104%; height: 25px;
    background: var(--icing-white);
    border-radius: 10px 10px 30px 30px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.2);
    background: linear-gradient(to bottom, var(--icing-white), #eee);
}
.tier-frosting::after {
    content: ''; position: absolute; bottom: -6px; right: 20%;
    width: 12px; height: 12px; background: var(--icing-white); border-radius: 50%;
    box-shadow: 0 2px 3px rgba(0,0,0,0.2);
}

/* --- MUMLAR --- */
.candles-container {
    position: absolute;
    top: -45px; /* Pastanın tepesinde */
    left: 50%; transform: translateX(-50%);
    display: flex; gap: 35px;
    z-index: 20;
}
.candle {
    position: relative; width: 12px; height: 45px;
    background: repeating-linear-gradient(45deg, #fff, #fff 5px, #29B6F6 5px, #29B6F6 10px);
    border-radius: 4px 4px 2px 2px;
    box-shadow: inset -2px 0 5px rgba(0,0,0,0.1), 2px 3px 5px rgba(0,0,0,0.3);
}
.candle.center { margin-top: -8px; background: repeating-linear-gradient(45deg, #fff, #fff 5px, #FF4081 5px, #FF4081 10px); height: 50px; }

.candle::before {
    content: ''; position: absolute; top: -8px; left: 50%; transform: translateX(-50%);
    width: 3px; height: 8px;
    background: linear-gradient(to bottom, #FF5722, #333 60%);
    border-radius: 2px;
}

/* Alev */
.flame {
    position: absolute; top: -26px; left: 50%; transform: translateX(-50%);
    width: 16px; height: 26px;
    background: radial-gradient(ellipse at bottom, #fff 20%, var(--flame-yellow) 50%, var(--flame-orange) 90%);
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    box-shadow: 0 0 20px var(--flame-yellow), 0 0 40px var(--flame-orange);
    animation: flameMove 0.15s infinite alternate ease-in-out;
    transform-origin: bottom center; transition: all 0.3s;
}
.flame.blowing { transform: translateX(-50%) skewX(15deg) scale(0.9); opacity: 0.7; filter: blur(1px); }
.flame.off { opacity: 0; transform: translateX(-50%) scale(0.1); }

@keyframes flameMove {
    0% { transform: translateX(-50%) scale(1) rotate(-2deg); }
    100% { transform: translateX(-50%) scale(1.1) rotate(2deg); }
}

.smoke {
    position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
    width: 6px; height: 15px; background: rgba(255,255,255,0.6);
    border-radius: 50%; filter: blur(4px); opacity: 0;
}
.smoke.rise { animation: smokeUp 2s forwards; }
@keyframes smokeUp {
    0% { opacity: 0.6; transform: translateX(-50%) translateY(0) scale(1); }
    100% { opacity: 0; transform: translateX(-30%) translateY(-60px) scale(4); }
}

/* --- ÇİLEKLER (DÜZELTİLDİ: EN TEPEYE ALINDI) --- */
.cherries {
    position: absolute; 
    top: -15px; /* DÜZELTME: Eksi değer vererek yukarı taşıdık */
    width: 100%;
    display: flex;
    justify-content: center-2;
    gap: 24px; 
    z-index: 21; /* Mumların önüne geçsin */
    pointer-events: none;
}
.cherry {
    position: relative;
    width: 22px; height: 20px;
    background: radial-gradient(circle at 30% 30%, #ff7675, #d63031 50%, #a10e0e 100%);
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    box-shadow: 0 3px 5px rgba(0,0,0,0.4), inset 0 -5px 5px rgba(0,0,0,0.3);
}
.cherry::before {
    content: ''; position: absolute; top: -5px; left: 30%;
    width: 2px; height: 6px; background: #3E2723; border-radius: 2px;
    transform: translateX(-50%) rotate(10deg);
}
.cherry:nth-child(2)::before { transform: translateX(-50%) rotate(-15deg); }

/* Tabak */
.plate {
    width: 340px; height: 15px;
    background: linear-gradient(to right, #cfcfcf, #ffffff, #cfcfcf);
    border-radius: 10px; margin-top: -5px; z-index: 1;
    box-shadow: 0 8px 15px rgba(0,0,0,0.4);
}

/* --- KONTROLLER --- */
.controls { margin-top: 70px; text-align: center; color: #ccc; transition: opacity 0.5s; }
.controls.hidden { opacity: 0; pointer-events: none; }
.hint { font-size: 0.9rem; margin-bottom: 15px; }
.hint span { color: #fff; font-weight: bold; }

.btn-group { position: relative; width: 90px; height: 90px; margin: 0 auto; }
#blowBtn { position: absolute; top: 5px; left: 5px; width: 80px; height: 80px; border-radius: 50%; border: none; background: rgba(255,255,255,0.1); font-size: 32px; cursor: pointer; color: #fff; transition: transform 0.1s; }
#blowBtn:active { transform: scale(0.95); background: rgba(255,255,255,0.2); }

.progress-ring { transform: rotate(-90deg); }
.progress-circle { stroke-dasharray: 251; stroke-dashoffset: 251; transition: stroke-dashoffset 0.1s linear; stroke: #69F0AE; }

#giftBtn { margin-top: 40px; padding: 15px 50px; border-radius: 30px; background: linear-gradient(45deg, #FF4081, #FF80AB); color: #fff; font-weight: bold; border: none; font-size: 1.3rem; cursor: pointer; opacity: 0; pointer-events: none; transition: opacity 1s, transform 0.3s; box-shadow: 0 5px 15px rgba(255, 64, 129, 0.4); }
#giftBtn.visible { opacity: 1; pointer-events: auto; }
#giftBtn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255, 64, 129, 0.6); }

@media (max-width: 600px) { .cake-wrapper { transform: scale(0.85); margin-top: 30px; } .title { font-size: 3rem; } }